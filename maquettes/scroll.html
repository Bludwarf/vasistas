<!DOCTYPE html>
<html lang="fr">
    <head>
        <title>Vasistas - Géolocalisation sur un paysage</title> 
		
    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
	<script src="http://maps.googleapis.com/maps/api/js?libraries=geometry"></script>
    <!--<script src="js/svg-utils.js"></script>-->
    <!--<script src="js/stab.js"></script>-->
    <!--<script src="js/basse.js"></script>-->
	<link rel="stylesheet" type="text/css" href="styles.css" />
	
    <script type="text/javascript" src="vasistas.Place.js"></script>
    <script type="text/javascript" src="vasistas.Zone.js"></script>
    <script type="text/javascript" src="vasistas.Map.js"></script>
    <script type="text/javascript" src="scroll.js"></script>
	
    </head>
    <body>
		
		<div id="left">
			<div id="left-top">
				<div id="googleMap"></div>
			</div>
			<div id="left-bottom">
				<div id="lists" >
					<div id="points">
						<h2>Points de contrôle</h2>
                        <div id="ctrl-points">
                            <table>
                                <tr><td>#1</td><td>8px,23px</td><td>pos</td><td>149.0°</td>
                                <tr><td>#2</td><td>8px,23px</td><td>pos</td><td>149.0°</td>
                                <tr><td>#3</td><td>8px,23px</td><td>pos</td><td>149.0°</td>
                                <tr><td>#4</td><td>8px,23px</td><td>pos</td><td>149.0°</td>
                                <tr><td>#5</td><td>8px,23px</td><td>pos</td><td>149.0°</td>
                            </table>
                        </div>
					</div>
				</div>
			</div>
		</div>
		
		<div id="middle">
			<div id="tools">
                <div class="tool" onclick="javascript:photo.selectTool(tools.move)">Move</div>
				<div class="tool" onclick="javascript:photo.selectTool(tools.point)">Point</div>
				<div class="tool">Angle</div>
			</div>
		</div>

        <!--<object data="Basse.svg" type="image/svg+xml" id="alphasvg" width="100%" height="100%"></object>-->
		<!-- width="693px"
	 height="2371px" -->
		<!-- width="100%" height="90%" -->
		<!-- viewBox="0 0 693 2371" -->
		<!-- viewBox="0 300 693 1575" -->
		<div id="right">
			<div id="photo-dock">
				<div id="photo" class="photo-drag"></div>
                <div id="photo-overlays">
                    <canvas id="photo-overlay-angle" width="1236" height="684"></canvas>
                </div>
				<div id="photo-shadows"></div>
				<div id="photo-infos">infos</div>
				<div id="photo-hub">
					<code>rova.jpg</code>
				</div>
			</div>
		</div>
        
        
        
    <script>
    	$(document).ready(function() {
            
            var degToRad = Math.PI / 180;
            function rad(deg) {
                return deg * degToRad;
            }
            function deg(rad) {
                return rad / degToRad;
            }
            
            //var αE = -31.13; // °
            //var lE = -880;   // px
            var αE = 194.8583-184.5952; // appart.JPG : centre -> facade beige
            var lE = 1203-960;   // px
            var ρE = Math.tan(rad(αE))/lE;
            var angleIxus = function(x,y, width, height) {
                var dx = x - width / 2;
                return deg(Math.atan(dx*ρE));
            };
            
            var dxIxus = function(angle) {
                return Math.tan(rad(angle)) / ρE;
            };
            
            photo.init({
                div: "photo",
                photo: {
                    
                    // IXUS
                    width: 1920,
                    height: 1080,
                    
                    filename: "../photos/rova.jpg",
                    //lat: -18.923014,
                    //lng: 47.532082,
                    lat: -18.923857,
                    lng: 47.531719,
                    pm : 20,
                    
                    /*filename: "../photos/appart.JPG",
                    lat: 48.106314,
                    lng: -1.666214,
                    pm : 1,*/
            
                    // EOS
                    /*width: 2592,
                    height: 1728,
            
                    filename: '../photos/18-55/IMG_0254.JPG',
                    lat: -18.907185, // Chez Francis
                    lng:  47.527982, // Chez Francis
                    pm: 5,*/
                    
                    getAngle: angleIxus,
                    dx: dxIxus
                },
                infos: "photo-infos",
                dock: "photo-dock",
                ctrlPoints: "ctrl-points"
            });
            photo.points.add([
                
                // Rova.jpg 
                {
                    name: 'Lac Anda. A bottom-left',
                    dir: 272.718915972411,
                    x: 250,
                    lat: -18.922657,
                    lng: 47.514780
                }, {
                    name: 'Lac Anda. B top-left',
                    dir: 273.203208362151,
                    x: 250,
                    lat: -18.922366,
                    lng: 47.510606
                }, {
                    name: 'Lac Anda. C bottom-right',
                    dir: 275.263572205116,
                    x: 327,
                    lat: -18.922027,
                    lng:  47.515155
                },
                {
                    name: 'Lac Anda. D top-right',
                    dir: 275.755325674204,
                    x: 318,
                    lat: -18.921509,
                    lng:  47.510537
                },
                {
                    name: 'Tour Anda. gauche',
                    x: 275,
                    lat: -18.922884,
                    lng:  47.519834
                },
                {
                    name: 'Tour Anda. droite',
                    x: 289,
                    lat: -18.922784,
                    lng:  47.519785
                },
                {
                    name: 'Cabane foot',
                    dir: 278.66,
                    x: 427
                }, {
                    name: 'Arbre hypodrome',
                    dir: 288.94,
                    x: 677
                }, {
                    name: 'Bord gauche de l\'immeuble à droite de l\'hypo',
                    dir: 292.24,
                    x: 763
                },
                {
                    name: 'Bord droit de l\'immeuble à droite de l\'hypo',
                    dir: 293.21,
                    x: 789
                },
                {
                    name: 'Tour Anosy gauche',
                    x: 1244,
                    lat: -18.912715,
                    lng:  47.519531
                },
                {
                    name: 'Tour Anosy droite',
                    x: 1264,
                    lat: -18.912618,
                    lng:  47.519692
                }
                
                // Photo appart.jpg
                /*{
                    name: 'Eglise',
                    x: 946,
                    lat:  48.095133,
                    lng: -1.667443
                },
                {
                    name: 'Centre (église clocher gauche)',
                    x: 960,
                    lat:  48.095287,
                    lng: -1.667541
                },
                {
                    name: 'Facade beige',
                    x: 1203,
                    lat:  48.101773,
                    lng: -1.668018
                }*/
            
            
                // IMG_0254.JPG
                /*{
                    name: 'Clocher vert',
                    x: 350,
                    lat: -18.914523,
                    lng:  47.528910
                }*/
            ]);
            photo.view.revealAll();
            //photo.view.zoom(2); 
            
            
            
            
            
            
            // GOOGLE
            map = new vasistas.Map(document.getElementById("googleMap"), {
                photo: photo
            });

    	});
    </script>

    </body>
</html>